%\chapter{Introduction to Linear Programming}
\chapter{TSP}

\paragraph{Problem setting}
Given a list of $n$ cities and the distance $c_{ij}$ from $i$ to $j$, 
find a \emph{tour} for the salesman such that
each city is visited exactly once, before the salesman returns to the originating city, with
total distance minimized.
The variants can be added the assumption:
\begin{itemize}
\item
symmetric: $c_{ij}=c_{ji}$
\item
Euclidean: $c_{ij}$ is the Euclidean distance between $i$ and $j$ in $2$-dimension plane
\item
Triangle Inequality: $c_{ij}\le c_{ik}+c_{kj},\forall i,j,k$
\end{itemize}
Suppose the actual travel distance/time between the cities is given by $d_{ij}$,
Let $c_{ij}$be the shortest path from $i$ to $j$ (wrt $d_{ij}$ ),
then $c_{ij}$ satisfy the triangle inequality. The actual travel may pass through some cities more than once, but every city is visited.

\section{Heuristics Method for Finding TSP Tour}

\paragraph{Nearest Neighbour}
\begin{enumerate}
\item
Choose a city as originating city $i_1$ and $S_1=\{i_1\},k=1$
\item
For $k=1:n$:
\begin{itemize}
\item
Find a city not in $S_k$ but closest to $i_k$, i.e., $i_{k+1} = \arg\min_{j\notin S_k}c_{i_k, j}$
\item
Let $S_{k+1}=(i_1,\dots,i_k,i_{k+1})$
\end{itemize}
\end{enumerate}
However, the solution obtained can be arbitrarily bad, i.e., for any $r\ge1$, 
we can construct an example where the ratio of the NN solution to the optimal TSP exceeds $r$.
The idea: the tour successive driven towards a city where it is then forced to travel along an edge of large distance.

\paragraph{Nearest Addition}
\begin{enumerate}
\item
Start with a tour $S$ of a single city.
\item
Find a city not in $S$ closest to the tour $S$, i.e., $\min_{i\in S,j\notin S}c_{ij}$, say $c_{k\ell}=\arg\min_{i\in S,j\notin S}c_{ij}$.
\item
Let $(k,p)$ be an edge incident to $k$ on the tour $S$, replace it by $(k,\ell)$ and $(\ell,p)$, i.e., $\ell$ is inserted into the tour $S$ next to $k$.
\item
Repeat from step 2 unitl the tour is complete.
\end{enumerate}



\paragraph{Nearest Insertion}
\begin{enumerate}
\item
Find a city $\ell$ closest to the tour $S$ as above
\item
Insert $\ell$ between $u$ and $v$ on the tour $S$,
which minimizes the increase in tour length, i.e., replace $(u,v)$ of $S$
by $(u,\ell)$ and $(\ell,v)$ that minimizes
\[
\min_{(i,j)\in S}c_{i\ell}+c_{\ell j}-c_{ij}
\]
\item
Repeat until the tour is complete
\end{enumerate}

Now we consider the TSP with \emph{non-negative symmetric} distances satisfying the \emph{trianglular inequality}.
\paragraph{Minimum Spanning Tree Heuristic}
\begin{enumerate}
\item
Find a minimum weight spanning tree
\item
Duplicate each edge in the spanning tree – to get an Eulerian graph.
\item
Follow the Eulerian circuit and ``skip ahead'' if about to re-visit the city.
\end{enumerate}
\begin{theorem}
Let MST be the value of the tour obtained by the Minimum Spanning Tree heuristic;
Let $SP^*$ be the value of the Minimum Spanning Tree;
Let $TSP^*$ be the value of the optimal Travelling Salesman Tour.
For any instance of the problem, $MST\le 2TSP^*$.
\end{theorem}
\begin{proof}
$MST\le 2SP^*$. For the optimal tour, if we remove one edge of the tour, we get a spanning tree.
Therefore $SP^*\le TSP^*$, which follows
\[
MST\le2 SP^*\le 2TSP^*
\]
\end{proof}

\paragraph{Christofides' Heuristic}
A graph is Eulerian iff every vertex has even degree. 
We aim to get an Eulerian graph without doubling a spanning tree.
Recall that in a spanning tree, there are an even number of vertices of \emph{odd degree}.
\begin{enumerate}
\item
Find a minimum weight spanning tree.
\item
Find a minimum weight perfect matching of value $M^*$ for the vertices
of odd degree in the spanning tree.
\item
The edges of the spanning tree, together with the edges of the matching yields an Eulerian graph. Find an Eulerian circuit.
\item
To construct the TSP, follow the Eulerian circuit and “skip ahead” if next city has already been visited.
\end{enumerate}
\begin{theorem}
Let CH be the value of the tour obtained by Christofides’ heuristic, then
\[
CH\le \frac{3}{2}TSP^*
\]
\end{theorem}
\begin{proof}
By the triangle inequality, $CH\le SP^*+M^*$. 
Consider an optimal TSP tour, follow it and \emph{skip} all the vertices of even degree in the optimal spanning tree $SP^*$, and we get a sub-tour $S$.
By triangle inequality, the total distance $S\le TSP^*$.
The edges of $S$ can be partitioned into two matchings, $M_1$ and $M_2$, on the odd vertices of $SP^*$.
Since the total length of the matchings is bounded by $TSP^*$,
one of the two matchings must have length no greater than $TSP^*/2$.
Therefore $M^*\le TSP^*/2$.

Also note that $SP^*\le TSP^*$.
\end{proof}


\paragraph{Clarke-Wright Savings}
Start with a set of sub-tours each originating at the depot city.
Consider the savings if two cities $y$ and $z$ are put on the same sub-tour.
Then save the distances.


The Clarke-Wright Savings algorithm begins with each sub-tour consisting of a trip from the depot to a single city. The pair of cities yielding the most savings when linked is first linked. Linking continues until one tour remains.


\section{TSP Formulation as an Integer Programming}

\begin{align*}
\min&\sum_{e\in E}c_ex_e\\
\text{such that}&\sum_{e\in\delta(i)}x_e=2,\ \forall i\in V\\
&\sum_{\{e=(i,j)\mid i\in Q,j\notin Q\}}x_e\ge2,\ \forall\emptyset\subseteq Q\subseteq V\\
&0\le x_e\le 1,\ \text{integer}, \forall e\in E
\end{align*}

We can add additional valid inequalities so we can solve TSP as a linear program:

Consider subsets of vertices $H,T_1,\dots,T_k\subseteq V$, with
\begin{align*}
|H\cap T_i|&\ge1\\
|T_i\setminus H|&\ge1\\
T_i\cap T_j&=\emptyset\\
\sum_{e\in E(H)}x_e+\sum_{i=1}^k\sum_{e\in E(T_i)}x_e&\le |H|+\sum_{i=1}^k(|T_i|-1)-\lceil\frac{k}{2}\rceil
\end{align*}
This is the subtour elimination constraints
































